function strands  = mctNfgFibers2Strands(fg,radius)
%
% Transforms a fiber group into NFG strands. 
%
%  strands = mctNfgFibers2Strands(fg,[radius])
%
%  *fg* is a fiber group, as generted by fgCreate.m
%  *strands* is a collection of NFG strands (fibers) as generated by NFG.
%    
%  *radius* the fiber radius can be used to display the weights.
%             so it can either be passed in as a single number (same radius for
%             all fibers) or can be passed in as a a vector length(fg.fibers)
%
% by Franco Pestilli
%
% see also:
%     mctNfgLoadStrands.m 
%
% (C) 2012 Stanford VISTA team. 

if notDefined('radius'), 
    radius=0.05; % proportion of voxel volume
end
if ~((length(radius) == 1) || (length(radius) == length(fg.fibers)))
    error('[%s]\nDiameter can either be a single number or\na collection of weights (one weigthper fiber).',mfilename) 
end

% Strip off first and last points from strand
numFibers = length(fg.fibers);
strands = cell(numFibers + 1,4);

for ll = 1:numFibers
    strands{ll,1} = fg.fibers{ll}';   
    strands{ll,2}   = ll - 1;        
    strands{ll,4}   = ll - 1;
    strands{ll,3}   = radius;
end

% the fibers name is sotred in the last position of the strand collection
strands{ll+1,1}   = fg.name;

return